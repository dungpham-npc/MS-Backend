Index: milkstore/src/main/resources/application.properties
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>spring.application.name=milkstore\r\n\r\nspring.jpa.hibernate.ddl-auto=update\r\nspring.datasource.url=jdbc:mysql://localhost:3306/milkstore\r\nspring.datasource.username=su\r\nspring.datasource.password=12345678%\r\nspring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver\r\n\r\nspring.security.oauth2.client.registration.google.client-id=835688269831-eqof3tesihdcclkml07a7ne7gei2g1sk.apps.googleusercontent.com\r\nspring.security.oauth2.client.registration.google.client-secret=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\r\n\r\nspring.mail.host=smtp.gmail.com\r\nspring.mail.port=587\r\nspring.mail.username=dung04.testing@gmail.com\r\nspring.mail.password=jeyf faei aend wgyz\r\nspring.mail.properties.mail.smtp.auth=true\r\nspring.mail.properties.mail.smtp.starttls.enable=true\r\n\r\nmilkstore.app.jwtSecret= 404E635266556A586E3272357538782F413F4428472B4B6250645367566B5970\r\nmilkstore.app.jwtExpirationMs= 8640000\r\n\r\npayment.vnPay.url=${PAY_URL:https://sandbox.vnpayment.vn/paymentv2/vpcpay.html}\r\npayment.vnPay.tmnCode=${TMN_CODE:6ASCYNFB}\r\npayment.vnPay.secretKey=${SECRET_KEY:3LO399OLOBBFZLF648PM66PUMKVTYDWE}\r\npayment.vnPay.returnUrl=${RETURN_URL:http://localhost:8080/payment/vn-pay-callback}\r\npayment.vnPay.version=${VERSION:2.1.0}\r\npayment.vnPay.command=${COMMAND:pay}\r\npayment.vnPay.orderType=${ORDER_TYPE:other}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>ISO-8859-1
===================================================================
diff --git a/milkstore/src/main/resources/application.properties b/milkstore/src/main/resources/application.properties
--- a/milkstore/src/main/resources/application.properties	
+++ b/milkstore/src/main/resources/application.properties	
@@ -2,8 +2,8 @@
 
 spring.jpa.hibernate.ddl-auto=update
 spring.datasource.url=jdbc:mysql://localhost:3306/milkstore
-spring.datasource.username=su
-spring.datasource.password=12345678%
+spring.datasource.username=root
+spring.datasource.password=123456
 spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver
 
 spring.security.oauth2.client.registration.google.client-id=835688269831-eqof3tesihdcclkml07a7ne7gei2g1sk.apps.googleusercontent.com
Index: milkstore/src/main/java/com/cookswp/milkstore/service/shoppingcart/ShoppingCartService.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package com.cookswp.milkstore.service.shoppingcart;\r\n\r\nimport com.cookswp.milkstore.enums.Status;\r\nimport com.cookswp.milkstore.pojo.dtos.CartModel.AddToCartDTO;\r\nimport com.cookswp.milkstore.pojo.dtos.CartModel.ShowCartModelDTO;\r\nimport com.cookswp.milkstore.pojo.dtos.CartModel.UpdateToCartDTO;\r\nimport com.cookswp.milkstore.pojo.entities.Product;\r\nimport com.cookswp.milkstore.pojo.entities.ShoppingCart;\r\n\r\nimport com.cookswp.milkstore.pojo.entities.ShoppingCartItem;\r\n//import com.cookswp.milkstore.repository.ProductRepository;\r\n//import com.cookswp.milkstore.repository.ShoppingCartRepository;\r\nimport com.cookswp.milkstore.repository.product.ProductRepository;\r\nimport com.cookswp.milkstore.repository.shoppingCart.ShoppingCartRepository;\r\nimport com.cookswp.milkstore.repository.shoppingCartItem.ShoppingCartItemRepository;\r\nimport org.springframework.beans.factory.annotation.Autowired;\r\nimport org.springframework.stereotype.Service;\r\n\r\n\r\nimport java.util.List;\r\nimport java.util.Optional;\r\nimport java.util.stream.Collectors;\r\n\r\n@Service\r\npublic class ShoppingCartService implements IShoppingCartService{\r\n\r\n    @Autowired\r\n    private ShoppingCartRepository shoppingCartRepository;\r\n    @Autowired\r\n    private ProductRepository productRepository;\r\n    @Autowired\r\n    private ShoppingCartItemRepository shoppingCartItemRepository;\r\n\r\n\r\n\r\n    @Override\r\n    public List<ShowCartModelDTO> getCartByUserId(int userId) {\r\n        Optional<ShoppingCart> cartOptional =shoppingCartRepository.findByUserId(userId);\r\n        if (!cartOptional.isPresent()) {\r\n            throw new RuntimeException(\"Shopping cart not found\");\r\n        }\r\n        ShoppingCart shoppingCart = cartOptional.get();\r\n\r\n        List<ShowCartModelDTO.CartItemModel> items = shoppingCart.getItems().stream()\r\n                .map(item -> {\r\n                    ShowCartModelDTO.CartItemModel cartItemModel = new ShowCartModelDTO.CartItemModel();\r\n                    cartItemModel.setProductId(item.getProduct().getProductID());\r\n                    cartItemModel.setProductName(item.getProduct().getProductName());\r\n                    cartItemModel.setQuantity(item.getQuantity());\r\n                    cartItemModel.setPrice(item.getProduct().getPrice());\r\n                    return cartItemModel;\r\n                })\r\n                .collect(Collectors.toList());\r\n        ShowCartModelDTO showCartModelDTO = new ShowCartModelDTO();\r\n        showCartModelDTO.setUserId(userId);\r\n        showCartModelDTO.setItems(items);\r\n\r\n        return List.of(showCartModelDTO);\r\n    }\r\n\r\n    @Override\r\n    public ShoppingCart addToCart(AddToCartDTO addToCartDTO, int userId) {\r\n        ShoppingCart cart = shoppingCartRepository.findByUserId(userId)\r\n                .orElseGet(() -> {\r\n                    ShoppingCart newCart = new ShoppingCart();\r\n                    newCart.setUserId(userId);\r\n                    return shoppingCartRepository.save(newCart);\r\n                });\r\n\r\n        //sẽ sửa lại khi set được status sau khi thanh toán.\r\n        Product product = productRepository.findById(addToCartDTO.getProduct_id()).orElseThrow(() -> new RuntimeException(\"Product not found\"));\r\n        Optional<ShoppingCartItem> existingItemOpt = cart.getItems().stream().filter(item -> item.getProduct().getProductID() == product.getProductID()).findFirst();\r\n        if (existingItemOpt.isPresent()) {\r\n            ShoppingCartItem existingItem = existingItemOpt.get();\r\n            existingItem.setQuantity(existingItem.getQuantity() + addToCartDTO.getQuantity());\r\n            shoppingCartItemRepository.save(existingItem);\r\n\r\n        } else {\r\n            ShoppingCartItem newItem = new ShoppingCartItem();\r\n            newItem.setShoppingCart(cart);\r\n            newItem.setProduct(product);\r\n            newItem.setQuantity(addToCartDTO.getQuantity());\r\n            shoppingCartItemRepository.save(newItem);\r\n        }\r\n        return cart;\r\n    }\r\n\r\n    @Override\r\n    public ShoppingCart deleteToCart(int cartId, int userId) {\r\n        ShoppingCart cart = shoppingCartRepository.findByIdAndUserId(cartId, userId).orElseThrow(() -> new RuntimeException(\"Shopping cart not found\"));\r\n        shoppingCartRepository.delete(cart);\r\n        return cart;\r\n    }\r\n\r\n    @Override\r\n    public ShoppingCart updateItem(UpdateToCartDTO updateToCartDTO, int cartId, int userId) {\r\n        ShoppingCart cart = shoppingCartRepository.findByIdAndUserId(cartId, userId).orElseThrow(() -> new RuntimeException(\"Shopping cart not found\"));\r\n        ShoppingCartItem item = cart.getItems().stream().filter(shoppingCartItem -> shoppingCartItem.getProduct().getProductID() == updateToCartDTO.getProduct_id()).findFirst().orElseThrow(() -> new RuntimeException(\"Item not found in Cart !!\"));\r\n\r\n\r\n        //Sẽ sửa lại khi biết cách setup status\r\n        item.setQuantity(updateToCartDTO.getQuantity());\r\n        shoppingCartItemRepository.save(item);\r\n        return cart;\r\n    }\r\n\r\n    public void updateCartStatus (ShoppingCart cart, Status status) {\r\n        cart.setStatus(status);\r\n        shoppingCartRepository.save(cart);\r\n    }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/milkstore/src/main/java/com/cookswp/milkstore/service/shoppingcart/ShoppingCartService.java b/milkstore/src/main/java/com/cookswp/milkstore/service/shoppingcart/ShoppingCartService.java
--- a/milkstore/src/main/java/com/cookswp/milkstore/service/shoppingcart/ShoppingCartService.java	
+++ b/milkstore/src/main/java/com/cookswp/milkstore/service/shoppingcart/ShoppingCartService.java	
@@ -10,10 +10,12 @@
 import com.cookswp.milkstore.pojo.entities.ShoppingCartItem;
 //import com.cookswp.milkstore.repository.ProductRepository;
 //import com.cookswp.milkstore.repository.ShoppingCartRepository;
+import com.cookswp.milkstore.pojo.entities.User;
 import com.cookswp.milkstore.repository.product.ProductRepository;
 import com.cookswp.milkstore.repository.shoppingCart.ShoppingCartRepository;
 import com.cookswp.milkstore.repository.shoppingCartItem.ShoppingCartItemRepository;
 import org.springframework.beans.factory.annotation.Autowired;
+import org.springframework.security.core.context.SecurityContextHolder;
 import org.springframework.stereotype.Service;
 
 
Index: .idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"AutoImportSettings\">\r\n    <option name=\"autoReloadType\" value=\"SELECTIVE\" />\r\n  </component>\r\n  <component name=\"ChangeListManager\">\r\n    <list default=\"true\" id=\"f2c39ff5-8b99-4c8e-9f3c-52770c2e8229\" name=\"Changes\" comment=\"\">\r\n      <change afterPath=\"$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Checkout_at_6_13_2024_3_35_PM__Changes_.xml\" afterDir=\"false\" />\r\n      <change afterPath=\"$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Checkout_at_6_13_2024_3_35_PM__Changes_1.xml\" afterDir=\"false\" />\r\n      <change afterPath=\"$PROJECT_DIR$/.idea/vcs.xml\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/milkstore/src/main/java/com/cookswp/milkstore/pojo/entities/ShoppingCart.java\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/milkstore/src/main/java/com/cookswp/milkstore/pojo/entities/ShoppingCart.java\" afterDir=\"false\" />\r\n    </list>\r\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\r\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\r\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\r\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\r\n  </component>\r\n  <component name=\"Git.Settings\">\r\n    <option name=\"RECENT_BRANCH_BY_REPOSITORY\">\r\n      <map>\r\n        <entry key=\"$PROJECT_DIR$\" value=\"main\" />\r\n      </map>\r\n    </option>\r\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$\" />\r\n  </component>\r\n  <component name=\"PropertiesComponent\"><![CDATA[{\r\n  \"keyToString\": {\r\n    \"SHARE_PROJECT_CONFIGURATION_FILES\": \"true\",\r\n    \"git-widget-placeholder\": \"HuuHien\",\r\n    \"node.js.detected.package.eslint\": \"true\",\r\n    \"node.js.detected.package.tslint\": \"true\",\r\n    \"node.js.selected.package.eslint\": \"(autodetect)\",\r\n    \"node.js.selected.package.tslint\": \"(autodetect)\"\r\n  }\r\n}]]></component>\r\n  <component name=\"RunManager\">\r\n    <configuration name=\"MilkstoreApplication\" type=\"SpringBootApplicationConfigurationType\" factoryName=\"Spring Boot\" nameIsGenerated=\"true\">\r\n      <option name=\"FRAME_DEACTIVATION_UPDATE_POLICY\" value=\"UpdateClassesAndResources\" />\r\n      <module name=\"milkstore\" />\r\n      <option name=\"SPRING_BOOT_MAIN_CLASS\" value=\"com.cookswp.milkstore.MilkstoreApplication\" />\r\n      <method v=\"2\">\r\n        <option name=\"Make\" enabled=\"true\" />\r\n      </method>\r\n    </configuration>\r\n  </component>\r\n  <component name=\"TaskManager\">\r\n    <servers />\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/workspace.xml b/.idea/workspace.xml
--- a/.idea/workspace.xml	
+++ b/.idea/workspace.xml	
@@ -5,10 +5,14 @@
   </component>
   <component name="ChangeListManager">
     <list default="true" id="f2c39ff5-8b99-4c8e-9f3c-52770c2e8229" name="Changes" comment="">
-      <change afterPath="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Checkout_at_6_13_2024_3_35_PM__Changes_.xml" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Checkout_at_6_13_2024_3_35_PM__Changes_1.xml" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/.idea/vcs.xml" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/milkstore/src/main/java/com/cookswp/milkstore/pojo/entities/ShoppingCart.java" beforeDir="false" afterPath="$PROJECT_DIR$/milkstore/src/main/java/com/cookswp/milkstore/pojo/entities/ShoppingCart.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/.idea/dataSources.local.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/dataSources.local.xml" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Checkout_at_6_13_2024_3_35_PM__Changes_.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Checkout_at_6_13_2024_3_35_PM__Changes_.xml" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Checkout_at_6_13_2024_3_35_PM__Changes_1.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/shelf/Uncommitted_changes_before_Checkout_at_6_13_2024_3_35_PM__Changes_1.xml" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/workspace.xml" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/milkstore/src/main/java/com/cookswp/milkstore/service/shoppingcart/ShoppingCartService.java" beforeDir="false" afterPath="$PROJECT_DIR$/milkstore/src/main/java/com/cookswp/milkstore/service/shoppingcart/ShoppingCartService.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/milkstore/src/main/java/com/cookswp/milkstore/service/user/UserService.java" beforeDir="false" afterPath="$PROJECT_DIR$/milkstore/src/main/java/com/cookswp/milkstore/service/user/UserService.java" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/milkstore/src/main/resources/application.properties" beforeDir="false" afterPath="$PROJECT_DIR$/milkstore/src/main/resources/application.properties" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/milkstore/src/test/java/com/cookswp/milkstore/service/UserServiceTest.java" beforeDir="false" afterPath="$PROJECT_DIR$/milkstore/src/test/java/com/cookswp/milkstore/service/UserServiceTest.java" afterDir="false" />
     </list>
     <option name="SHOW_DIALOG" value="false" />
     <option name="HIGHLIGHT_CONFLICTS" value="true" />
@@ -25,8 +29,13 @@
   </component>
   <component name="PropertiesComponent"><![CDATA[{
   "keyToString": {
+    "RequestMappingsPanelOrder0": "0",
+    "RequestMappingsPanelOrder1": "1",
+    "RequestMappingsPanelWidth0": "75",
+    "RequestMappingsPanelWidth1": "75",
     "SHARE_PROJECT_CONFIGURATION_FILES": "true",
-    "git-widget-placeholder": "HuuHien",
+    "Spring Boot.MilkstoreApplication.executor": "Run",
+    "git-widget-placeholder": "main",
     "node.js.detected.package.eslint": "true",
     "node.js.detected.package.tslint": "true",
     "node.js.selected.package.eslint": "(autodetect)",
Index: .idea/dataSources.local.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"dataSourceStorageLocal\" created-in=\"IU-241.15989.150\">\r\n    <data-source name=\"milkstore@localhost\" uuid=\"09a85143-56cb-497f-b74b-734822ded8f3\">\r\n      <database-info product=\"\" version=\"\" jdbc-version=\"\" driver-name=\"\" driver-version=\"\" dbms=\"MYSQL\" />\r\n      <schema-mapping />\r\n    </data-source>\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/dataSources.local.xml b/.idea/dataSources.local.xml
--- a/.idea/dataSources.local.xml	
+++ b/.idea/dataSources.local.xml	
@@ -1,7 +1,7 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <project version="4">
   <component name="dataSourceStorageLocal" created-in="IU-241.15989.150">
-    <data-source name="milkstore@localhost" uuid="09a85143-56cb-497f-b74b-734822ded8f3">
+    <data-source name="milkstore@localhost" uuid="6b12fe08-8ef1-4a8f-9802-2d6dcf3a1001">
       <database-info product="" version="" jdbc-version="" driver-name="" driver-version="" dbms="MYSQL" />
       <schema-mapping />
     </data-source>
